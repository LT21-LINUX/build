#
# SPDX-License-Identifier: GPL-2.0
#
# Copyright (c) 2013-2023 Igor Pecovnik, igor@armbian.com
#
# This file is a part of the Armbian Build Framework
# https://github.com/armbian/build/
#
declare -g ARCH="arm64"
SERIALCON='ttyPS0'
LINUXFAMILY=vs680

KERNELSOURCE='https://github.com/LT21-LINUX/pi-linux.git'
declare -g KERNEL_MAJOR_MINOR="5.4" # Major and minor versions of this kernel
KERNELBRANCH='branch:pi-5.4-vs680'
KERNELDIR='linux-vs680'
KERNELPATCHDIR='legacy'
ATF_COMPILE="no"

BOOTSOURCE='https://github.com/LT21-LINUX/pi-u-boot.git'
BOOTBRANCH='branch:v2019.10-vs680'
BOOTCONFIG="vs680_spi_boot_defconfig"
BOOTDIR='u-boot-vs680'
BOOTSCRIPT='boot-vs680.cmd:boot.cmd'
BOOTENV_FILE='vs680.txt'
UBOOT_TARGET_MAP=';;u-boot.bin'

family_tweaks() {
	true
}

# @TODO: rpardini: this is leaking into the host system (/usr/local), let's not
compile_vs680_bootgen() {
	# Source code checkout
	echo "compile_vs680_bootgen"
}

uboot_custom_postprocess() {
	echo "uboot_custom_postprocess"
}

write_uboot_platform() {
	echo "write_uboot_platform"
	echo dd if=$SRC/packages/blobs/vs680/bpi-m6-tzk-4MB.bin of=$2 bs=512 seek=1 conv=notrunc
	dd if=$SRC/packages/blobs/vs680/bpi-m6-tzk-4MB.bin of=$2 bs=512 seek=1 conv=notrunc
	echo "dd if=$1/u-boot.bin of=$2 bs=1k seek=2048 status=noxfer > /dev/null 2>&1"
	dd if=$1/u-boot.bin of=$2 bs=1k seek=2048 status=noxfer > /dev/null 2>&1
}
